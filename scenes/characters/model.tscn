[gd_scene load_steps=40 format=3 uid="uid://b5t7f8r1backb"]

[ext_resource type="Script" uid="uid://qr66qvlcjtk7" path="res://scripts/characters/model.gd" id="1_8ddow"]
[ext_resource type="Curve" uid="uid://ct3njrgm7bpap" path="res://assets/animations/anim_crossover_right.tres" id="2_dn0ju"]
[ext_resource type="AnimationNodeBlendSpace2D" uid="uid://d0dpxauu8ifrv" path="res://assets/animations/move_blend_tree.tres" id="3_bnshe"]
[ext_resource type="Script" uid="uid://b0u67k5bc8g6l" path="res://scripts/resources/stroke_animation.gd" id="3_wv0r8"]
[ext_resource type="AnimationNodeBlendTree" uid="uid://bay3hh3awjm8t" path="res://assets/animations/stroke_blend_tree.tres" id="4_1xcp4"]
[ext_resource type="PackedScene" uid="uid://djp08wf63mwsq" path="res://assets/models/player/player_djokovic.glb" id="4_wv0r8"]
[ext_resource type="Script" uid="uid://bn6tlcpxi7l1t" path="res://scripts/utilities/free_look_camera.gd" id="8_4mh3o"]

[sub_resource type="Resource" id="Resource_wv0r8"]
script = ExtResource("3_wv0r8")
hit_time = 0.63
metadata/_custom_type_script = "uid://b0u67k5bc8g6l"

[sub_resource type="Resource" id="Resource_4mh3o"]
script = ExtResource("3_wv0r8")
hit_time = 0.32
metadata/_custom_type_script = "uid://b0u67k5bc8g6l"

[sub_resource type="Resource" id="Resource_oci05"]
script = ExtResource("3_wv0r8")
hit_time = 0.63
metadata/_custom_type_script = "uid://b0u67k5bc8g6l"

[sub_resource type="BoxShape3D" id="50"]
size = Vector3(1.14, 2.037, 0.656)

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_6rst8"]
animation = &"g_idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_k6wyo"]
advance_mode = 2
advance_condition = &"moving"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_lj1u1"]
advance_mode = 2
advance_condition = &"idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_bnshe"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_6rst8"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_os7wk"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_os7wk"]
states/g_idle/node = SubResource("AnimationNodeAnimation_6rst8")
states/g_idle/position = Vector2(357, 99)
states/move/node = ExtResource("3_bnshe")
states/move/position = Vector2(512, 86)
states/stroke/node = ExtResource("4_1xcp4")
states/stroke/position = Vector2(655, 92)
transitions = ["g_idle", "move", SubResource("AnimationNodeStateMachineTransition_k6wyo"), "move", "g_idle", SubResource("AnimationNodeStateMachineTransition_lj1u1"), "Start", "g_idle", SubResource("AnimationNodeStateMachineTransition_bnshe"), "move", "stroke", SubResource("AnimationNodeStateMachineTransition_6rst8"), "stroke", "move", SubResource("AnimationNodeStateMachineTransition_os7wk")]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_8sm40"]
animation = &"g_run_forward"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_dbqhb"]
animation = &"g_run_right"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_t4p63"]
animation = &"g_run_left"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_4tsxh"]
animation = &"g_active_idle"

[sub_resource type="AnimationNodeBlendSpace2D" id="AnimationNodeBlendSpace2D_mttge"]
blend_point_0/node = SubResource("AnimationNodeAnimation_8sm40")
blend_point_0/pos = Vector2(0, 1)
blend_point_1/node = SubResource("AnimationNodeAnimation_dbqhb")
blend_point_1/pos = Vector2(1, 0)
blend_point_2/node = SubResource("AnimationNodeAnimation_t4p63")
blend_point_2/pos = Vector2(-1, 0)
blend_point_3/node = SubResource("AnimationNodeAnimation_4tsxh")
blend_point_3/pos = Vector2(0, 0)

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_wv0r8"]
animation = &"g_forehand"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_bnshe"]
animation = &"g_serve"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_oci05"]
animation = &"g_forehand_open"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_wgdgj"]
animation = &"g_backhand_slice"

[sub_resource type="AnimationNodeTimeScale" id="AnimationNodeTimeScale_4mh3o"]

[sub_resource type="AnimationNodeTimeScale" id="AnimationNodeTimeScale_wv0r8"]

[sub_resource type="AnimationNodeTransition" id="AnimationNodeTransition_6rst8"]
input_0/name = "forehand"
input_0/auto_advance = false
input_0/break_loop_at_end = false
input_0/reset = true
input_1/name = "backhand"
input_1/auto_advance = false
input_1/break_loop_at_end = false
input_1/reset = true
input_2/name = "serve"
input_2/auto_advance = false
input_2/break_loop_at_end = false
input_2/reset = true
input_3/name = "backhand_slice"
input_3/auto_advance = false
input_3/break_loop_at_end = false
input_3/reset = true
input_4/name = "forehand_open"
input_4/auto_advance = false
input_4/break_loop_at_end = false
input_4/reset = true

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ntho4"]
animation = &"g_backhand_down"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_dc20h"]
animation = &"g_backhand"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_tp0co"]
animation = &"g_backhand_up"

[sub_resource type="AnimationNodeBlendSpace1D" id="AnimationNodeBlendSpace1D_4tsxh"]
blend_point_0/node = SubResource("AnimationNodeAnimation_ntho4")
blend_point_0/pos = 0.0
blend_point_1/node = SubResource("AnimationNodeAnimation_dc20h")
blend_point_1/pos = 0.5
blend_point_2/node = SubResource("AnimationNodeAnimation_tp0co")
blend_point_2/pos = 1.0
min_space = 0.0

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_k6wyo"]
graph_offset = Vector2(-46.29834, -84.42261)
nodes/output/position = Vector2(1120, 100)
nodes/backhand/node = SubResource("AnimationNodeBlendSpace1D_4tsxh")
nodes/backhand/position = Vector2(-40, 160)
nodes/Animation/node = SubResource("AnimationNodeAnimation_wgdgj")
nodes/Animation/position = Vector2(100, 400)
"nodes/Animation 3/node" = SubResource("AnimationNodeAnimation_bnshe")
"nodes/Animation 3/position" = Vector2(-60, 300)
nodes/Transition/node = SubResource("AnimationNodeTransition_6rst8")
nodes/Transition/position = Vector2(560, 60)
"nodes/Animation 2/node" = SubResource("AnimationNodeAnimation_wv0r8")
"nodes/Animation 2/position" = Vector2(20, 0)
nodes/TimeScale/node = SubResource("AnimationNodeTimeScale_wv0r8")
nodes/TimeScale/position = Vector2(380, 60)
"nodes/Animation 4/node" = SubResource("AnimationNodeAnimation_oci05")
"nodes/Animation 4/position" = Vector2(40, 560)
"nodes/TimeScale 2/node" = SubResource("AnimationNodeTimeScale_4mh3o")
"nodes/TimeScale 2/position" = Vector2(380, 460)
node_connections = [&"output", 0, &"Transition", &"Transition", 0, &"TimeScale", &"Transition", 1, &"backhand", &"Transition", 2, &"Animation 3", &"Transition", 3, &"Animation", &"Transition", 4, &"TimeScale 2", &"TimeScale", 0, &"Animation 2", &"TimeScale 2", 0, &"Animation 4"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_7lfwa"]
xfade_time = 0.18

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_j06ue"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_1e60p"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_dxleo"]
states/Start/position = Vector2(137, 112)
states/move/node = SubResource("AnimationNodeBlendSpace2D_mttge")
states/move/position = Vector2(400, 109)
states/stroke/node = SubResource("AnimationNodeBlendTree_k6wyo")
states/stroke/position = Vector2(567, 111)
transitions = ["move", "stroke", SubResource("AnimationNodeStateMachineTransition_7lfwa"), "stroke", "move", SubResource("AnimationNodeStateMachineTransition_j06ue"), "Start", "move", SubResource("AnimationNodeStateMachineTransition_1e60p")]
graph_offset = Vector2(43.48047, 56.632813)

[node name="Model" type="Node3D" unique_id=1656989274 node_paths=PackedStringArray("animation_tree")]
script = ExtResource("1_8ddow")
_movement_animations = Dictionary[String, Resource]({
"crossover_right": ExtResource("2_dn0ju")
})
_stroke_animations = Dictionary[String, ExtResource("3_wv0r8")]({
"backhand": SubResource("Resource_wv0r8"),
"backhand_slice": SubResource("Resource_4mh3o"),
"forehand": SubResource("Resource_oci05")
})
animation_tree = NodePath("AnimationTree")

[node name="h" type="Node3D" parent="." unique_id=833081922]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)

[node name="player_djokovic" parent="h" unique_id=2063783272 instance=ExtResource("4_wv0r8")]

[node name="DEF-attachment_hand_R" parent="h/player_djokovic/game-rig/GeneralSkeleton" parent_id_path=PackedInt32Array(2063783272, 383728423) index="0" unique_id=1107378455]
transform = Transform3D(0.9999998, 1.1920923e-07, -9.53674e-07, -9.536743e-07, 7.0780565e-08, -0.99999964, -1.19209275e-07, 0.99999946, 7.078074e-08, -0.513018, 1.1044233, 0.20742942)

[node name="RacketForehand" type="Area3D" parent="." unique_id=1166534911]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.2348056, 1.21593, -0.21618477)

[node name="CollisionShape3D" type="CollisionShape3D" parent="RacketForehand" unique_id=630654229]
shape = SubResource("50")

[node name="RacketBackhand" type="Area3D" parent="." unique_id=687313289]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.8034267, 1.21593, 0.0040946826)

[node name="CollisionShape3D" type="CollisionShape3D" parent="RacketBackhand" unique_id=1805301375]
shape = SubResource("50")

[node name="Points" type="Node3D" parent="." unique_id=692645137]

[node name="BallServePoint" type="Marker3D" parent="Points" unique_id=1013838841]
transform = Transform3D(1.0000005, 0, 0, 0, 0.9999976, 0, 0, 0, 1, 0.16375381, 2.6329153, -0.7290658)

[node name="BallTossPoint" type="Marker3D" parent="Points" unique_id=1125444751]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.151763, 1.93189, -0.490733)

[node name="BackhandSlicePoint" type="Marker3D" parent="Points" unique_id=899088371]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.9745234, 1.2685952, -0.22437423)

[node name="BackhandSliceDownPoint" type="Marker3D" parent="Points" unique_id=26002251]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.666439, 0.491877, -0.24975309)

[node name="BackhandSliceUpPoint" type="Marker3D" parent="Points" unique_id=1629217222]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.03961, 1.62896, -0.24975309)

[node name="BackhandPoint" type="Marker3D" parent="Points" unique_id=1192745020]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.83030283, 0.9525981, -0.45003307)

[node name="BackhandDownPoint" type="Marker3D" parent="Points" unique_id=253200836]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.839683, 0.5094303, -0.2468817)

[node name="BackhandUpPoint" type="Marker3D" parent="Points" unique_id=1849591341]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.88906235, 1.4934098, -0.38709083)

[node name="ForehandPoint" type="Marker3D" parent="Points" unique_id=180524840]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.3610765, 1.2253153, -0.54735845)

[node name="ForehandDownPoint" type="Marker3D" parent="Points" unique_id=944679888]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.1703565, 0.5880548, -0.60338837)

[node name="ForehandUpPoint" type="Marker3D" parent="Points" unique_id=395348627]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.3476162, 1.7261463, -0.59341383)

[node name="AnimationTreeRootMotion" type="AnimationTree" parent="." unique_id=2021565860]
root_motion_track = NodePath("game-rig/Skeleton3D:root")
tree_root = SubResource("AnimationNodeStateMachine_os7wk")
parameters/conditions/idle = false
parameters/conditions/moving = false
parameters/move/blend_position = Vector2(-0.19970602, -0.08251464)
parameters/stroke/Transition/current_state = "forehand"
parameters/stroke/Transition/transition_request = ""
parameters/stroke/Transition/current_index = 0

[node name="AnimationTree" type="AnimationTree" parent="." unique_id=697911821]
active = false
root_node = NodePath("../h/player_djokovic")
tree_root = SubResource("AnimationNodeStateMachine_dxleo")
anim_player = NodePath("../h/player_djokovic/AnimationPlayer")
parameters/move/blend_position = Vector2(1.4834096, -0.16701162)
parameters/stroke/backhand/blend_position = 0.6078915
parameters/stroke/Transition/current_state = "forehand_open"
parameters/stroke/Transition/transition_request = ""
parameters/stroke/Transition/current_index = 4
parameters/stroke/TimeScale/scale = 1.0
"parameters/stroke/TimeScale 2/scale" = 1.0

[node name="RootMotionView" type="RootMotionView" parent="." unique_id=1034132174]
animation_path = NodePath("../AnimationTreeRootMotion")

[node name="Camera3D" type="Camera3D" parent="." unique_id=723465327]
transform = Transform3D(-1, 0, 8.742278e-08, 0, 1, 0, -8.742278e-08, 0, -1, 0, 0.86121607, -2.023045)
script = ExtResource("8_4mh3o")

[editable path="h/player_djokovic"]
